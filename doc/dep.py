graphCmd = 'modulegraph.exe -x BaseHTTPServer -x BmpImagePlugin -x ConfigParser -x EasyDialogs -x FixTk -x GifImagePlugin -x GimpGradientFile -x GimpPaletteFile -x ICCProfile -x Image -x ImageChops -x ImageColor -x ImageFile -x ImageMode -x ImagePalette -x ImageShow -x JpegImagePlugin -x MacOS -x OrderedDict -x PIL -x PIL.BmpImagePlugin -x PIL.GifImagePlugin -x PIL.GimpGradientFile -x PIL.GimpPaletteFile -x PIL.Image -x PIL.ImageChops -x PIL.ImageColor -x PIL.ImageDraw -x PIL.ImageDraw2 -x PIL.ImageFile -x PIL.ImageFont -x PIL.ImageMode -x PIL.ImagePalette -x PIL.ImagePath -x PIL.ImageShow -x PIL.JpegImagePlugin -x PIL.PaletteFile -x PIL.PngImagePlugin -x PIL.PpmImagePlugin -x PIL.TiffImagePlugin -x PIL.TiffTags -x PIL._imaging -x PIL._imagingft -x PaletteFile -x PngImagePlugin -x PpmImagePlugin -x PyQt4 -x PyQt4.QtCore -x PyQt4.QtGui -x PyQt4.QtNetwork -x PyQt4.QtWebKit -x PyQt4.Qwt5 -x PyQt4.Qwt5.Qwt -x SOCKS -x SQLiteSession -x SocketServer -x StringIO -x TiffImagePlugin -x TiffTags -x Tkconstants -x Tkinter -x UserDict -x _LWPCookieJar -x _MozillaCookieJar -x __builtin__ -x __future__ -x _abcoll -x _bisect -x _bytesio -x _codecs -x _collections -x _ctypes -x _dummy_threading -x _emx_link -x _fileio -x _functools -x _hashlib -x _heapq -x _imaging -x _imaging_gif -x _imagingagg -x _locale -x _md5 -x _random -x _scproxy -x _sha -x _sha256 -x _sha512 -x _socket -x _sqlite3 -x _sre -x _ssl -x _struct -x _subprocess -x _symtable -x _threading_local -x _tkinter -x _warnings -x _weakref -x _win32sysloader -x _winreg -x _xmlplus -x abc -x array -x atexit -x base64 -x bdb -x binascii -x bisect -x builtins -x bz2 -x cPickle -x cStringIO -x calendar -x ce -x cmd -x codecs -x collections -x colorsys -x commands -x commctrl -x compileall -x compiler -x compiler.ast -x compiler.consts -x compiler.future -x compiler.misc -x compiler.pyassem -x compiler.pycodegen -x compiler.symbols -x compiler.syntax -x compiler.transformer -x compiler.visitor -x cookielib -x copy -x copy_reg -x ctypes -x ctypes._endian -x datetime -x difflib -x dis -x distutils -x distutils.dep_util -x distutils.errors -x distutils.log -x distutils.spawn -x distutils.sysconfig -x distutils.text_file -x distutils.util -x doctest -x docutils -x docutils._compat -x docutils.core -x docutils.frontend -x docutils.io -x docutils.languages -x docutils.nodes -x docutils.parsers -x docutils.parsers.rst -x docutils.parsers.rst.directives -x docutils.parsers.rst.languages -x docutils.parsers.rst.languages.en -x docutils.parsers.rst.roles -x docutils.parsers.rst.states -x docutils.parsers.rst.tableparser -x docutils.readers -x docutils.readers.doctree -x docutils.readers.standalone -x docutils.statemachine -x docutils.transforms -x docutils.transforms.frontmatter -x docutils.transforms.misc -x docutils.transforms.references -x docutils.transforms.universal -x docutils.urischemes -x docutils.utils -x docutils.writers -x docutils.writers.odf_odt -x docutils.writers.odf_odt.pygmentsformatter -x dummy_thread -x dummy_threading -x elementtree -x email -x email._parseaddr -x email.base64mime -x email.charset -x email.encoders -x email.errors -x email.feedparser -x email.generator -x email.header -x email.iterators -x email.message -x email.mime -x email.parser -x email.quoprimime -x email.utils -x encodings -x encodings.aliases -x errno -x exceptions -x fcntl -x fnmatch -x formatter -x ftplib -x functools -x gc -x genericpath -x gestalt -x getopt -x getpass -x gettext -x glob -x globalData -x gzip -x hashlib -x heapq -x httplib -x ic -x imp -x inspect -x io -x itertools -x java.lang -x keyword -x linecache -x locale -x logging -x macurl2path -x marshal -x math -x mimetools -x mimetypes -x mmap -x msvcrt -x new -x nose -x nose.plugins -x nose.plugins.base -x nose.plugins.builtin -x nose.plugins.errorclass -x nose.tools -x nose.util -x nt -x ntpath -x nturl2path -x numpy -x numpy.__config__ -x numpy._import_tools -x numpy.add_newdocs -x numpy.core -x numpy.core._dotblas -x numpy.core._internal -x numpy.core._sort -x numpy.core.arrayprint -x numpy.core.defchararray -x numpy.core.defmatrix -x numpy.core.fromnumeric -x numpy.core.info -x numpy.core.memmap -x numpy.core.multiarray -x numpy.core.numeric -x numpy.core.numerictypes -x numpy.core.records -x numpy.core.scalarmath -x numpy.core.umath -x numpy.ctypeslib -x numpy.dual -x numpy.fft -x numpy.fft.fftpack -x numpy.fft.fftpack_lite -x numpy.fft.helper -x numpy.fft.info -x numpy.lib -x numpy.lib._compiled_base -x numpy.lib._datasource -x numpy.lib._iotools -x numpy.lib.arraysetops -x numpy.lib.arrayterator -x numpy.lib.financial -x numpy.lib.format -x numpy.lib.function_base -x numpy.lib.getlimits -x numpy.lib.index_tricks -x numpy.lib.info -x numpy.lib.io -x numpy.lib.machar -x numpy.lib.polynomial -x numpy.lib.scimath -x numpy.lib.shape_base -x numpy.lib.stride_tricks -x numpy.lib.twodim_base -x numpy.lib.type_check -x numpy.lib.ufunclike -x numpy.lib.utils -x numpy.linalg -x numpy.linalg.info -x numpy.linalg.lapack_lite -x numpy.linalg.linalg -x numpy.ma -x numpy.ma.core -x numpy.ma.extras -x numpy.ma.mrecords -x numpy.numarray -x numpy.numarray.compat -x numpy.numarray.functions -x numpy.numarray.numerictypes -x numpy.numarray.session -x numpy.numarray.ufuncs -x numpy.numarray.util -x numpy.random -x numpy.random.info -x numpy.random.mtrand -x numpy.testing -x numpy.testing.decorators -x numpy.testing.noseclasses -x numpy.testing.nosetester -x numpy.testing.numpytest -x numpy.testing.utils -x numpy.version -x opcode -x operator -x optparse -x org.python.core -x os -x os.path -x os2 -x os2emxpath -x parser -x pdb -x pickle -x pkg_resources -x pkgutil -x platform -x posix -x posixpath -x pprint -x pwd -x py_compile -x pydoc -x pydoc_topics -x pyexpat -x pygments -x pygments.cmdline -x pygments.console -x pygments.filter -x pygments.filters -x pygments.formatter -x pygments.formatters -x pygments.formatters._mapping -x pygments.formatters.bbcode -x pygments.formatters.html -x pygments.formatters.img -x pygments.formatters.latex -x pygments.formatters.other -x pygments.formatters.rtf -x pygments.formatters.svg -x pygments.formatters.terminal -x pygments.formatters.terminal256 -x pygments.lexers -x pygments.lexers._mapping -x pygments.plugin -x pygments.styles -x pygments.token -x pygments.util -x pythoncom -x pywin -x pywin.dialogs -x pywin.dialogs.list -x pywin.dialogs.status -x pywin.mfc -x pywin.mfc.dialog -x pywin.mfc.object -x pywin.mfc.thread -x pywin.mfc.window -x pywintypes -x quopri -x random -x re -x readline -x repr -x rfc822 -x riscos -x riscosenviron -x riscospath -x roman -x rourl2path -x scipy -x select -x sets -x sha -x shlex -x shutil -x signal -x signals -x sip -x socket -x sqlite3 -x sqlite3.dbapi2 -x sre_compile -x sre_constants -x sre_parse -x ssl -x stat -x string -x strop -x struct -x subprocess -x symbol -x symtable -x sys -x tempfile -x termios -x textwrap -x thread -x threading -x time -x token -x tokenize -x traceback -x tty -x types -x unicodedata -x unittest -x urllib -x urllib2 -x urlparse -x user -x uu -x vms_lib -x warnings -x weakref -x webbrowser -x win32api -x win32com -x win32com.client -x win32com.client.CLSIDToClass -x win32com.client.build -x win32com.client.dynamic -x win32com.client.gencache -x win32com.client.genpy -x win32com.client.makepy -x win32com.client.selecttlb -x win32com.client.util -x win32com.gen_py -x win32com.shell -x win32con -x win32pdh -x win32pipe -x win32process -x win32ui -x winerror -x xml -x xml.dom -x xml.dom.NodeFilter -x xml.dom.domreg -x xml.dom.expatbuilder -x xml.dom.minicompat -x xml.dom.minidom -x xml.dom.pulldom -x xml.dom.xmlbuilder -x xml.etree -x xml.etree.ElementPath -x xml.etree.ElementTree -x xml.parsers -x xml.parsers.expat -x xml.sax -x xml.sax._exceptions -x xml.sax.expatreader -x xml.sax.handler -x xml.sax.saxutils -x xml.sax.xmlreader -x zipfile -x zipimport -x zlib -g %s'

import sys,os,glob,subprocess,re
cmd = graphCmd % (sys.argv[1])
p = subprocess.Popen(cmd,stdout=subprocess.PIPE).communicate()[0]
lines = p.split('\n')
excludes = ['ExcludedModule']
for l in lines:
    m = re.search(r'"(\S+)".*ExcludedModule',l)
    if m: excludes.append(m.group(1))
    #print excludes
    toPrint = True
    for x in excludes: 
        if re.search('"%s"' % x, l): toPrint = False
    if toPrint:
        print l

